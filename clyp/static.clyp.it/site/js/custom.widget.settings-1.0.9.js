/*! howler.js v2.0.4 | (c) 2013-2017, James Simpson of GoldFire Studios | MIT License | howlerjs.com */
function CustomWidgetUtil(){}!function(){"use strict";var e=function(){this.init()};e.prototype={init:function(){var e=this||t;return e._counter=1e3,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.mobileAutoEnable=!0,e._setup(),e},volume:function(e){var n=this||t;if(e=parseFloat(e),n.ctx||d(),void 0!==e&&e>=0&&e<=1){if(n._volume=e,n._muted)return n;n.usingWebAudio&&(n.masterGain.gain.value=e);for(var o=0;o<n._howls.length;o++)if(!n._howls[o]._webAudio)for(var i=n._howls[o]._getSoundIds(),r=0;r<i.length;r++){var a=n._howls[o]._soundById(i[r]);a&&a._node&&(a._node.volume=a._volume*e)}return n}return n._volume},mute:function(e){var n=this||t;n.ctx||d(),n._muted=e,n.usingWebAudio&&(n.masterGain.gain.value=e?0:n._volume);for(var o=0;o<n._howls.length;o++)if(!n._howls[o]._webAudio)for(var i=n._howls[o]._getSoundIds(),r=0;r<i.length;r++){var a=n._howls[o]._soundById(i[r]);a&&a._node&&(a._node.muted=!!e||a._muted)}return n},unload:function(){for(var e=this||t,n=e._howls.length-1;n>=0;n--)e._howls[n].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,d()),e},codecs:function(e){return(this||t)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||t;if(e.state=e.ctx&&e.ctx.state||"running",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||t,n=null;try{n="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!n||"function"!=typeof n.canPlayType)return e;var o=n.canPlayType("audio/mpeg;").replace(/^no$/,""),i=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),r=i&&parseInt(i[0].split("/")[1],10)<33;return e._codecs={mp3:!(r||!o&&!n.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!o,opus:!!n.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!n.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!n.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!n.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(n.canPlayType("audio/x-m4a;")||n.canPlayType("audio/m4a;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(n.canPlayType("audio/x-mp4;")||n.canPlayType("audio/mp4;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!n.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!n.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!n.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(n.canPlayType("audio/x-flac;")||n.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_enableMobileAudio:function(){var e=this||t,n=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(e._navigator&&e._navigator.userAgent),o=!!("ontouchend"in window||e._navigator&&e._navigator.maxTouchPoints>0||e._navigator&&e._navigator.msMaxTouchPoints>0);if(!e._mobileEnabled&&e.ctx&&(n||o)){e._mobileEnabled=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var i=function(){t._autoResume();var n=e.ctx.createBufferSource();n.buffer=e._scratchBuffer,n.connect(e.ctx.destination),void 0===n.start?n.noteOn(0):n.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),n.onended=function(){n.disconnect(0),e._mobileEnabled=!0,e.mobileAutoEnable=!1,document.removeEventListener("touchend",i,!0)}};return document.addEventListener("touchend",i,!0),e}},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&t.usingWebAudio){for(var n=0;n<e._howls.length;n++)if(e._howls[n]._webAudio)for(var o=0;o<e._howls[n]._sounds.length;o++)if(!e._howls[n]._sounds[o]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout((function(){e.autoSuspend&&(e._suspendTimer=null,e.state="suspending",e.ctx.suspend().then((function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())})))}),3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&t.usingWebAudio)return"running"===e.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state?(e.ctx.resume().then((function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")})),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var t=new e,n=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};n.prototype={init:function(e){var n=this;return t.ctx||d(),n._autoplay=e.autoplay||!1,n._format="string"!=typeof e.format?e.format:[e.format],n._html5=e.html5||!1,n._muted=e.mute||!1,n._loop=e.loop||!1,n._pool=e.pool||5,n._preload="boolean"!=typeof e.preload||e.preload,n._rate=e.rate||1,n._sprite=e.sprite||{},n._src="string"!=typeof e.src?e.src:[e.src],n._volume=void 0!==e.volume?e.volume:1,n._duration=0,n._state="unloaded",n._sounds=[],n._endTimers={},n._queue=[],n._onend=e.onend?[{fn:e.onend}]:[],n._onfade=e.onfade?[{fn:e.onfade}]:[],n._onload=e.onload?[{fn:e.onload}]:[],n._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],n._onpause=e.onpause?[{fn:e.onpause}]:[],n._onplay=e.onplay?[{fn:e.onplay}]:[],n._onstop=e.onstop?[{fn:e.onstop}]:[],n._onmute=e.onmute?[{fn:e.onmute}]:[],n._onvolume=e.onvolume?[{fn:e.onvolume}]:[],n._onrate=e.onrate?[{fn:e.onrate}]:[],n._onseek=e.onseek?[{fn:e.onseek}]:[],n._onresume=[],n._webAudio=t.usingWebAudio&&!n._html5,void 0!==t.ctx&&t.ctx&&t.mobileAutoEnable&&t._enableMobileAudio(),t._howls.push(n),n._autoplay&&n._queue.push({event:"play",action:function(){n.play()}}),n._preload&&n.load(),n},load:function(){var e=this,n=null;if(!t.noAudio){"string"==typeof e._src&&(e._src=[e._src]);for(var i=0;i<e._src.length;i++){var a,u;if(e._format&&e._format[i])a=e._format[i];else{if("string"!=typeof(u=e._src[i])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(a=/^data:audio\/([^;,]+);/i.exec(u))||(a=/\.([^.]+)$/.exec(u.split("?",1)[0])),a&&(a=a[1].toLowerCase())}if(a||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),a&&t.codecs(a)){n=e._src[i];break}}return n?(e._src=n,e._state="loading","https:"===window.location.protocol&&"http:"===n.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new o(e),e._webAudio&&r(e),e):void e._emit("loaderror",null,"No codec support for selected audio sources.")}e._emit("loaderror",null,"No audio support.")},play:function(e,n){var o=this,i=null;if("number"==typeof e)i=e,e=null;else{if("string"==typeof e&&"loaded"===o._state&&!o._sprite[e])return null;if(void 0===e){e="__default";for(var r=0,a=0;a<o._sounds.length;a++)o._sounds[a]._paused&&!o._sounds[a]._ended&&(r++,i=o._sounds[a]._id);1===r?e=null:i=null}}var u=i?o._soundById(i):o._inactiveSound();if(!u)return null;if(i&&!e&&(e=u._sprite||"__default"),"loaded"!==o._state){u._sprite=e,u._ended=!1;var s=u._id;return o._queue.push({event:"play",action:function(){o.play(s)}}),s}if(i&&!u._paused)return n||setTimeout((function(){o._emit("play",u._id)}),0),u._id;o._webAudio&&t._autoResume();var d=Math.max(0,u._seek>0?u._seek:o._sprite[e][0]/1e3),l=Math.max(0,(o._sprite[e][0]+o._sprite[e][1])/1e3-d),c=1e3*l/Math.abs(u._rate);u._paused=!1,u._ended=!1,u._sprite=e,u._seek=d,u._start=o._sprite[e][0]/1e3,u._stop=(o._sprite[e][0]+o._sprite[e][1])/1e3,u._loop=!(!u._loop&&!o._sprite[e][2]);var _=u._node;if(o._webAudio){var p=function(){o._refreshBuffer(u);var e=u._muted||o._muted?0:u._volume;_.gain.setValueAtTime(e,t.ctx.currentTime),u._playStart=t.ctx.currentTime,void 0===_.bufferSource.start?u._loop?_.bufferSource.noteGrainOn(0,d,86400):_.bufferSource.noteGrainOn(0,d,l):u._loop?_.bufferSource.start(0,d,86400):_.bufferSource.start(0,d,l),c!==1/0&&(o._endTimers[u._id]=setTimeout(o._ended.bind(o,u),c)),n||setTimeout((function(){o._emit("play",u._id)}),0)},f="running"===t.state;if("loaded"===o._state&&f)p();else{var v=f||"loaded"!==o._state?"load":"resume";o.once(v,p,f?u._id:null),o._clearTimer(u._id)}}else{var m=function(){_.currentTime=d,_.muted=u._muted||o._muted||t._muted||_.muted,_.volume=u._volume*t.volume(),_.playbackRate=u._rate,_.play(),c!==1/0&&(o._endTimers[u._id]=setTimeout(o._ended.bind(o,u),c)),n||o._emit("play",u._id)},h="loaded"===o._state&&(window&&window.ejecta||!_.readyState&&t._navigator.isCocoonJS);if(4===_.readyState||h)m();else{var g=function(){m(),_.removeEventListener(t._canPlayEvent,g,!1)};_.addEventListener(t._canPlayEvent,g,!1),o._clearTimer(u._id)}}return u._id},pause:function(e){var t=this;if("loaded"!==t._state)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var n=t._getSoundIds(e),o=0;o<n.length;o++){t._clearTimer(n[o]);var i=t._soundById(n[o]);if(i&&!i._paused&&(i._seek=t.seek(n[o]),i._rateSeek=0,i._paused=!0,t._stopFade(n[o]),i._node))if(t._webAudio){if(!i._node.bufferSource)continue;void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),t._cleanBuffer(i._node)}else isNaN(i._node.duration)&&i._node.duration!==1/0||i._node.pause();arguments[1]||t._emit("pause",i?i._id:null)}return t},stop:function(e,t){var n=this;if("loaded"!==n._state)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var o=n._getSoundIds(e),i=0;i<o.length;i++){n._clearTimer(o[i]);var r=n._soundById(o[i]);r&&(r._seek=r._start||0,r._rateSeek=0,r._paused=!0,r._ended=!0,n._stopFade(o[i]),r._node&&(n._webAudio?r._node.bufferSource&&(void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),n._cleanBuffer(r._node)):isNaN(r._node.duration)&&r._node.duration!==1/0||(r._node.currentTime=r._start||0,r._node.pause())),t||n._emit("stop",r._id))}return n},mute:function(e,n){var o=this;if("loaded"!==o._state)return o._queue.push({event:"mute",action:function(){o.mute(e,n)}}),o;if(void 0===n){if("boolean"!=typeof e)return o._muted;o._muted=e}for(var i=o._getSoundIds(n),r=0;r<i.length;r++){var a=o._soundById(i[r]);a&&(a._muted=e,o._webAudio&&a._node?a._node.gain.setValueAtTime(e?0:a._volume,t.ctx.currentTime):a._node&&(a._node.muted=!!t._muted||e),o._emit("mute",a._id))}return o},volume:function(){var e,n,o,i=this,r=arguments;if(0===r.length)return i._volume;if(1===r.length||2===r.length&&void 0===r[1]?i._getSoundIds().indexOf(r[0])>=0?n=parseInt(r[0],10):e=parseFloat(r[0]):r.length>=2&&(e=parseFloat(r[0]),n=parseInt(r[1],10)),!(void 0!==e&&e>=0&&e<=1))return(o=n?i._soundById(n):i._sounds[0])?o._volume:0;if("loaded"!==i._state)return i._queue.push({event:"volume",action:function(){i.volume.apply(i,r)}}),i;void 0===n&&(i._volume=e),n=i._getSoundIds(n);for(var a=0;a<n.length;a++)(o=i._soundById(n[a]))&&(o._volume=e,r[2]||i._stopFade(n[a]),i._webAudio&&o._node&&!o._muted?o._node.gain.setValueAtTime(e,t.ctx.currentTime):o._node&&!o._muted&&(o._node.volume=e*t.volume()),i._emit("volume",o._id));return i},fade:function(e,n,o,i){var r=this,a=Math.abs(e-n),u=e>n?"out":"in",s=a/.01,d=s>0?o/s:o;if(d<4&&(s=Math.ceil(s/(4/d)),d=4),"loaded"!==r._state)return r._queue.push({event:"fade",action:function(){r.fade(e,n,o,i)}}),r;r.volume(e,i);for(var l=r._getSoundIds(i),c=0;c<l.length;c++){var _=r._soundById(l[c]);if(_){if(i||r._stopFade(l[c]),r._webAudio&&!_._muted){var p=t.ctx.currentTime,f=p+o/1e3;_._volume=e,_._node.gain.setValueAtTime(e,p),_._node.gain.linearRampToValueAtTime(n,f)}var v=e;_._interval=setInterval(function(t,o){s>0&&(v+="in"===u?.01:-.01),v=Math.max(0,v),v=Math.min(1,v),v=Math.round(100*v)/100,r._webAudio?(void 0===i&&(r._volume=v),o._volume=v):r.volume(v,t,!0),(n<e&&v<=n||n>e&&v>=n)&&(clearInterval(o._interval),o._interval=null,r.volume(n,t),r._emit("fade",t))}.bind(r,l[c],_),d)}}return r},_stopFade:function(e){var n=this,o=n._soundById(e);return o&&o._interval&&(n._webAudio&&o._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(o._interval),o._interval=null,n._emit("fade",e)),n},loop:function(){var e,t,n,o=this,i=arguments;if(0===i.length)return o._loop;if(1===i.length){if("boolean"!=typeof i[0])return!!(n=o._soundById(parseInt(i[0],10)))&&n._loop;e=i[0],o._loop=e}else 2===i.length&&(e=i[0],t=parseInt(i[1],10));for(var r=o._getSoundIds(t),a=0;a<r.length;a++)(n=o._soundById(r[a]))&&(n._loop=e,o._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=e,e&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop)));return o},rate:function(){var e,n,o,i=this,r=arguments;if(0===r.length)n=i._sounds[0]._id;else if(1===r.length){var a=i._getSoundIds(),u=a.indexOf(r[0]);u>=0?n=parseInt(r[0],10):e=parseFloat(r[0])}else 2===r.length&&(e=parseFloat(r[0]),n=parseInt(r[1],10));if("number"!=typeof e)return(o=i._soundById(n))?o._rate:i._rate;if("loaded"!==i._state)return i._queue.push({event:"rate",action:function(){i.rate.apply(i,r)}}),i;void 0===n&&(i._rate=e),n=i._getSoundIds(n);for(var s=0;s<n.length;s++)if(o=i._soundById(n[s])){o._rateSeek=i.seek(n[s]),o._playStart=i._webAudio?t.ctx.currentTime:o._playStart,o._rate=e,i._webAudio&&o._node&&o._node.bufferSource?o._node.bufferSource.playbackRate.value=e:o._node&&(o._node.playbackRate=e);var d=i.seek(n[s]),l=(i._sprite[o._sprite][0]+i._sprite[o._sprite][1])/1e3-d,c=1e3*l/Math.abs(o._rate);!i._endTimers[n[s]]&&o._paused||(i._clearTimer(n[s]),i._endTimers[n[s]]=setTimeout(i._ended.bind(i,o),c)),i._emit("rate",o._id)}return i},seek:function(){var e,n,o=this,i=arguments;if(0===i.length)n=o._sounds[0]._id;else if(1===i.length){var r=o._getSoundIds(),a=r.indexOf(i[0]);a>=0?n=parseInt(i[0],10):(n=o._sounds[0]._id,e=parseFloat(i[0]))}else 2===i.length&&(e=parseFloat(i[0]),n=parseInt(i[1],10));if(void 0===n)return o;if("loaded"!==o._state)return o._queue.push({event:"seek",action:function(){o.seek.apply(o,i)}}),o;var u=o._soundById(n);if(u){if(!("number"==typeof e&&e>=0)){if(o._webAudio){var s=o.playing(n)?t.ctx.currentTime-u._playStart:0,d=u._rateSeek?u._rateSeek-u._seek:0;return u._seek+(d+s*Math.abs(u._rate))}return u._node.currentTime}var l=o.playing(n);l&&o.pause(n,!0),u._seek=e,u._ended=!1,o._clearTimer(n),l&&o.play(n,!0),!o._webAudio&&u._node&&(u._node.currentTime=e),o._emit("seek",n)}return o},playing:function(e){var t=this;if("number"==typeof e){var n=t._soundById(e);return!!n&&!n._paused}for(var o=0;o<t._sounds.length;o++)if(!t._sounds[o]._paused)return!0;return!1},duration:function(e){var t=this,n=t._duration,o=t._soundById(e);return o&&(n=t._sprite[o._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var e=this,n=e._sounds,o=0;o<n.length;o++){n[o]._paused||e.stop(n[o]._id),e._webAudio||(/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent)||(n[o]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),n[o]._node.removeEventListener("error",n[o]._errorFn,!1),n[o]._node.removeEventListener(t._canPlayEvent,n[o]._loadFn,!1)),delete n[o]._node,e._clearTimer(n[o]._id);var r=t._howls.indexOf(e);r>=0&&t._howls.splice(r,1)}var a=!0;for(o=0;o<t._howls.length;o++)if(t._howls[o]._src===e._src){a=!1;break}return i&&a&&delete i[e._src],t.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,n,o){var i=this["_on"+e];return"function"==typeof t&&i.push(o?{id:n,fn:t,once:o}:{id:n,fn:t}),this},off:function(e,t,n){var o=this,i=o["_on"+e],r=0;if("number"==typeof t&&(n=t,t=null),t||n)for(r=0;r<i.length;r++){var a=n===i[r].id;if(t===i[r].fn&&a||!t&&a){i.splice(r,1);break}}else if(e)o["_on"+e]=[];else{var u=Object.keys(o);for(r=0;r<u.length;r++)0===u[r].indexOf("_on")&&Array.isArray(o[u[r]])&&(o[u[r]]=[])}return o},once:function(e,t,n){return this.on(e,t,n,1),this},_emit:function(e,t,n){for(var o=this,i=o["_on"+e],r=i.length-1;r>=0;r--)i[r].id&&i[r].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,n)}.bind(o,i[r].fn),0),i[r].once&&o.off(e,i[r].fn,i[r].id));return o},_loadQueue:function(){var e=this;if(e._queue.length>0){var t=e._queue[0];e.once(t.event,(function(){e._queue.shift(),e._loadQueue()})),t.action()}return e},_ended:function(e){var n=this,o=e._sprite;if(!n._webAudio&&n._node&&!n._node.ended)return setTimeout(n._ended.bind(n,e),100),n;var i=!(!e._loop&&!n._sprite[o][2]);if(n._emit("end",e._id),!n._webAudio&&i&&n.stop(e._id,!0).play(e._id),n._webAudio&&i){n._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=t.ctx.currentTime;var r=1e3*(e._stop-e._start)/Math.abs(e._rate);n._endTimers[e._id]=setTimeout(n._ended.bind(n,e),r)}return n._webAudio&&!i&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,n._clearTimer(e._id),n._cleanBuffer(e._node),t._autoSuspend()),n._webAudio||i||n.stop(e._id),n},_clearTimer:function(e){var t=this;return t._endTimers[e]&&(clearTimeout(t._endTimers[e]),delete t._endTimers[e]),t},_soundById:function(e){for(var t=this,n=0;n<t._sounds.length;n++)if(e===t._sounds[n]._id)return t._sounds[n];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new o(e)},_drain:function(){var e=this,t=e._pool,n=0,o=0;if(!(e._sounds.length<t)){for(o=0;o<e._sounds.length;o++)e._sounds[o]._ended&&n++;for(o=e._sounds.length-1;o>=0;o--){if(n<=t)return;e._sounds[o]._ended&&(e._webAudio&&e._sounds[o]._node&&e._sounds[o]._node.disconnect(0),e._sounds.splice(o,1),n--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],n=0;n<this._sounds.length;n++)t.push(this._sounds[n]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=t.ctx.createBufferSource(),e._node.bufferSource.buffer=i[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop),e._node.bufferSource.playbackRate.value=e._rate,this},_cleanBuffer:function(e){var t=this;if(t._scratchBuffer){e.bufferSource.onended=null,e.bufferSource.disconnect(0);try{e.bufferSource.buffer=t._scratchBuffer}catch(e){}}return e.bufferSource=null,t}};var o=function(e){this._parent=e,this.init()};o.prototype={init:function(){var e=this,n=e._parent;return e._muted=n._muted,e._loop=n._loop,e._volume=n._volume,e._rate=n._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++t._counter,n._sounds.push(e),e.create(),e},create:function(){var e=this,n=e._parent,o=t._muted||e._muted||e._parent._muted?0:e._volume;return n._webAudio?(e._node=void 0===t.ctx.createGain?t.ctx.createGainNode():t.ctx.createGain(),e._node.gain.setValueAtTime(o,t.ctx.currentTime),e._node.paused=!0,e._node.connect(t.masterGain)):(e._node=new Audio,e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(t._canPlayEvent,e._loadFn,!1),e._node.src=n._src,e._node.preload="auto",e._node.volume=o*t.volume(),e._node.load()),e},reset:function(){var e=this,n=e._parent;return e._muted=n._muted,e._loop=n._loop,e._volume=n._volume,e._rate=n._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++t._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,n=e._parent;n._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(n._sprite).length&&(n._sprite={__default:[0,1e3*n._duration]}),"loaded"!==n._state&&(n._state="loaded",n._emit("load"),n._loadQueue()),e._node.removeEventListener(t._canPlayEvent,e._loadFn,!1)}};var i={},r=function(e){var t=e._src;if(i[t])return e._duration=i[t].duration,void s(e);if(/^data:[^;]+;base64,/.test(t)){for(var n=atob(t.split(",")[1]),o=new Uint8Array(n.length),r=0;r<n.length;++r)o[r]=n.charCodeAt(r);u(o.buffer,e)}else{var d=new XMLHttpRequest;d.open("GET",t,!0),d.responseType="arraybuffer",d.onload=function(){var t=(d.status+"")[0];"0"===t||"2"===t||"3"===t?u(d.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+d.status+".")},d.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete i[t],e.load())},a(d)}},a=function(e){try{e.send()}catch(t){e.onerror()}},u=function(e,n){t.ctx.decodeAudioData(e,(function(e){e&&n._sounds.length>0&&(i[n._src]=e,s(n,e))}),(function(){n._emit("loaderror",null,"Decoding audio data failed.")}))},s=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},d=function(){try{"undefined"!=typeof AudioContext?t.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch(e){t.usingWebAudio=!1}var e=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),n=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),o=n?parseInt(n[1],10):null;if(e&&o&&o<9){var i=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());(t._navigator&&t._navigator.standalone&&!i||t._navigator&&!t._navigator.standalone&&!i)&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=void 0===t.ctx.createGain?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.value=t._muted?0:1,t.masterGain.connect(t.ctx.destination)),t._setup()};"function"==typeof define&&define.amd&&define([],(function(){return{Howler:t,Howl:n}})),"undefined"!=typeof exports&&(exports.Howler=t,exports.Howl=n),"undefined"!=typeof window?(window.HowlerGlobal=e,window.Howler=t,window.Howl=n,window.Sound=o):"undefined"!=typeof global&&(global.HowlerGlobal=e,global.Howler=t,global.Howl=n,global.Sound=o)}(),CustomWidgetUtil.newWindow=function(e,t,n){var o=function(){window.open(e,"t","scrollbars=yes,toolbar=0,resizable=1,status=0,width="+t+",height="+n)||(document.location.href=e)};/Firefox/.test(navigator.userAgent)?setTimeout(o,0):o()},CustomWidgetUtil.debounce=function(e,t,n){var o;return function(){var i=this,r=arguments,a=function(){o=null,n||e.apply(i,r)},u=n&&!o;clearTimeout(o),o=setTimeout(a,t),u&&e.apply(i,r)}};var ClypAnonymousApiClient=function(e,t,n){this.apiUrl=e,this.audioFileId=t,this.token=n};ClypAnonymousApiClient.prototype={tryAppendToken:function(e,t){return this.token?e+t+"token="+this.token:e},logAudioFileListen:function(){var e=this,t=e.apiUrl+e.audioFileId+"/log",n={url:e.tryAppendToken(t,"?"),type:"POST",beforeSend:function(e){e.setRequestHeader("X-Client-Type","WebPlayerWidget")},data:{Referrer:document.referrer}};return $.ajax(n)},startAudioFileDownload:function(){var e=this,t=e.apiUrl+e.audioFileId+"/downloadurl?fileType=mp3",n={url:e.tryAppendToken(t,"&"),type:"GET",dataType:"json",success:function(e){window.location=e.Url}};return $.ajax(n)},getSoundwaveData:function(e){return $.ajax({url:e,type:"GET",dataType:"json"})}};var Soundwave=function(e,t,n,o,i){var r=this,a="#D1D6DA",u=n;function s(){var e=$(r.soundwaveElement).width(),t=[],n=r.lineWidth+1,o=Math.floor(e/n),i=Math.floor(r.soundwaveData.length/o),u=0;function s(){return r.duration/t.length}r.soundwaveData.forEach((function(o,a){if(u+=o,a%i==0){var d=u/i;t.push(d),u=0}if(a===r.soundwaveData.length-1){var l,c=t.length*n;c>e+1?(l=(c-e)/t.length,r.lineWidth-=l,r.barDuration=s()):c<e-1?(l=(e-c)/t.length,r.lineWidth+=l,r.barDuration=s()):(r.barDuration=s(),r.lineWidth=3)}})),r.soundwaveData=t,function(){for(var e=$(r.soundwaveElement),t=SVG().addTo(r.soundwaveElement),n=(e.height()-10)/2/Math.max.apply(null,r.soundwaveData),o=[],i=0,u=e.height()/2,s=0;s<r.soundwaveData.length;s++){var d=r.soundwaveData[s]*n+2,l=t.rect(r.lineWidth,2*d).radius(3,2).fill(a).move(i,u-d);i+=r.lineWidth+1,o.push(l),s===r.soundwaveData.length-1&&(r.bars=o)}}()}r.bars=[],r.soundwaveData=null,r.apiResponseData=i,r.soundwaveElement=e,r.duration=o,r.barDuration=null,r.lastProgressIndex=0,r.percentComplete=0,r.lineWidth=3,r.apiResponseData?(r.soundwaveData=r.apiResponseData,s()):ClypAnonymousApiClient.prototype.getSoundwaveData(t).done((function(e){r.apiResponseData=e,r.soundwaveData=e,s()})),r.updateProgress=function(){var e,t=Math.floor(r.bars.length*r.percentComplete);if(r.lastProgressIndex<t)for(;r.lastProgressIndex<t;)(e=r.bars[r.lastProgressIndex])&&(1e3*r.barDuration>50?e.fill(a).animate(1e3*r.barDuration).fill(u):(e.timeline().stop(),e.fill(u))),++r.lastProgressIndex;if(r.lastProgressIndex>t)for(r.lastProgressIndex=r.bars.length;r.lastProgressIndex>=t;)(e=r.bars[r.lastProgressIndex])&&(e.timeline().stop(),e.fill(a)),--r.lastProgressIndex},r.resetSoundwave=function(){r.bars.forEach((function(e){e.fill(a)})),r.lastProgressIndex=0,r.updateProgress()},r.setPercentCompleteAndFillFromEmpty=function(e){r.percentComplete=e;var t=Math.floor(r.percentComplete*r.bars.length);r.lastProgressIndex=t;for(var n=0;n<t;n++)r.bars[n].fill(u)}},WidgetLinkSharingModel=function(e,t){this.playerPageUrl=t,this.openShareViewButton=e.openShareViewButton,this.closeShareViewButton=e.closeShareViewButton,this.containerElement=e.containerElement,this.linkToggleButton=e.linkToggleButton,this.embedToggleButton=e.embedToggleButton,this.linkTextInput=e.linkTextInput,this.embedTextInput=e.embedTextInput;var n=this;this.openShareViewButton.addEventListener("click",(function(){n.open()})),this.closeShareViewButton.addEventListener("click",(function(){n.close()})),this.linkToggleButton.addEventListener("click",(function(){n.showPlayerPageUrl()})),this.embedToggleButton.addEventListener("click",(function(){n.showPlayerWidgetHTML()}))};WidgetLinkSharingModel.prototype={open:function(){this.containerElement.classList.add("is-open")},close:function(){this.containerElement.classList.remove("is-open")},encodedPlayerPageUrl:function(){return encodeURIComponent(this.playerPageUrl)},facebookShare:function(){CustomWidgetUtil.newWindow("https://www.facebook.com/sharer/sharer.php?u="+this.encodedPlayerPageUrl(),755,425)},twitterShare:function(){CustomWidgetUtil.newWindow("https://twitter.com/intent/tweet?url="+this.encodedPlayerPageUrl()+"&via=Clyp_It",550,425)},redditShare:function(){CustomWidgetUtil.newWindow("https://www.reddit.com/submit?url="+this.encodedPlayerPageUrl(),900,720)},showPlayerPageUrl:function(){var e=this;e.linkToggleButton.classList.add("active"),e.embedToggleButton.classList.remove("active"),e.linkTextInput.style.display="block",e.embedTextInput.style.display="none"},showPlayerWidgetHTML:function(){var e=this;e.linkToggleButton.classList.remove("active"),e.embedToggleButton.classList.add("active"),e.linkTextInput.style.display="none",e.embedTextInput.style.display="block"}};var Player=function(e,t){var n,o,i,r=this;function a(e,t,n){return new Soundwave(e,t.soundwaveUrl,t.soundwaveColorHex,t.duration,n)}this.playlist=t,this.index=0,this.lastStepSeekPosition=null,this.lastStepSeekRoundedPosition=null,this.buffering=!1,this.canLogListen=!0,this.timer=e.timer,this.duration=e.duration,this.timeAgoLbl=e.timeAgoLabel,this.downloadButton=e.downloadButton,this.playBtn=e.playButton,this.pauseBtn=e.pauseButton,this.loadingBtn=e.loadingButton,this.loadingBtnTimeoutId=null,this.soundwave=a(e.soundwave,this.playlist[this.index],null),this.apiClient=(n=this.playlist[this.index],new ClypAnonymousApiClient(n.apiUrl,n.audioFileId,n.userProvidedToken)),o=r.playlist[r.index],i=new Date(o.dateCreated),r.timeAgoLbl.innerHTML="posted "+jQuery.timeago(i),r.timer.innerHTML=r.formatTime(0),r.duration.innerHTML=r.formatTime(Math.round(o.duration)),this.downloadButton&&this.downloadButton.addEventListener("click",(function(){r.apiClient.startAudioFileDownload()})),this.playBtn.addEventListener("click",(function(){r.play()})),this.pauseBtn.addEventListener("click",(function(){r.pause()})),this.soundwave.soundwaveElement.addEventListener("click",(function(e){var t=$(r.soundwave.soundwaveElement),n=(e.clientX-t.offset().left)/t.width();r.seek(n)})),this.redrawSoundwave=function(){var t=r.soundwave.percentComplete,n=r.soundwave.apiResponseData;$(r.soundwave.soundwaveElement).empty(),r.soundwave=a(e.soundwave,r.playlist[r.index],n),r.soundwave.setPercentCompleteAndFillFromEmpty(t)},$(window).resize(CustomWidgetUtil.debounce(this.redrawSoundwave,500))};Player.prototype={setSoundwaveColorHex:function(e){var t=this;t.playlist[t.index].soundwaveColorHex="#"+e,t.redrawSoundwave()},createHowl:function(e){var t=this;e="number"==typeof e?e:t.index;var n=t.playlist[e];return n.howl=new Howl({src:[n.mp3Url,n.oggUrl],html5:!0,onplay:function(){var e=n.howl;t.duration.innerHTML=t.formatTime(Math.round(e.duration())),requestAnimationFrame(t.step.bind(t)),t.showPauseButton(),e._html5&&e._sounds.length&&(e._sounds[0]._node.onwaiting=function(){e.playing()&&(t.buffering=!0,clearTimeout(t.loadingBtnTimeoutId),t.loadingBtnTimeoutId=setTimeout(t.showLoadingButton,100))})},onseek:function(){},onload:function(){},onend:function(){t.showPlayButton(),t.canLogListen=!0},onpause:function(){},onstop:function(){}}),n.howl},play:function(e){var t=this;e="number"==typeof e?e:t.index;var n=t.playlist[e];(n.howl?n.howl:t.createHowl(e)).play(),function(){if(!t.canLogListen)return;t.canLogListen=!1,t.apiClient.logAudioFileListen()}(),clearTimeout(t.loadingBtnTimeoutId),t.loadingBtnTimeoutId=setTimeout(t.showLoadingButton,100),t.index=e},pause:function(){var e=this;e.playlist[e.index].howl.pause(),e.showPlayButton()},skip:function(e){var t=this,n=0;"prev"===e?(n=t.index-1)<0&&(n=t.playlist.length-1):(n=t.index+1)>=t.playlist.length&&(n=0),t.skipTo(n)},skipTo:function(e){var t=this;t.playlist[t.index].howl&&t.playlist[t.index].howl.stop(),t.soundwave.percentComplete=0,t.soundwave.resetSoundwave(),t.play(e)},seek:function(e){var t=this,n=t.playlist[t.index].howl;n&&"loaded"===n.state()&&(n.seek(n.duration()*e),n.playing()||t.step())},step:function(){var e=this,t=e.playlist[e.index].howl,n=t.seek()||0,o=Math.round(n);o!==e.lastStepSeekRoundedPosition&&(e.timer.innerHTML=e.formatTime(o)),e.buffering&&n>e.lastStepSeekPosition&&n<=e.lastStepSeekPosition+1&&(e.buffering=!1,t.playing()?e.showPauseButton():e.showPlayButton()),e.lastStepSeekPosition=n,e.lastStepSeekRoundedPosition=o,e.soundwave.percentComplete=n/t.duration()||0,e.soundwave.updateProgress(),t.playing()&&requestAnimationFrame(e.step.bind(e))},showPlayButton:function(){var e=this;clearTimeout(e.loadingBtnTimeoutId),e.playBtn.style.display="block",e.pauseBtn.style.display="none",e.loadingBtn.style.display="none"},showPauseButton:function(){var e=this;clearTimeout(e.loadingBtnTimeoutId),e.playBtn.style.display="none",e.pauseBtn.style.display="block",e.loadingBtn.style.display="none"},showLoadingButton:function(){var e=this;e.playBtn.style.display="none",e.pauseBtn.style.display="none",e.loadingBtn.style.display="block"},formatTime:function(e){e=Number(e);var t=Math.floor(e/3600),n=Math.floor(e%3600/60),o=Math.floor(e%3600%60);return(t>0?t+":":"")+(n>0?(t>0&&n<10?"0":"")+n+":":t>0?"00:":"0:")+(o<10?"0":"")+o}};var CustomWidgetSettingsViewModel=function(e,t){var n=this,o=new RegExp("^([0-9a-fA-F]{3}){1,2}$"),i=null;function r(){return n.alertBox.visible()&&"red"===n.alertBox.color()}function a(e){var o=e.substring(1);n.soundwaveHex(o),t.setSoundwaveColorHex(o)}n.header=e,n.logoPreviewUrl=ko.observable(),n.soundwaveHex=ko.observable(),n.soundwaveHexSelector=ko.observable(),n.playButtonHex=ko.observable(),n.playButtonHexSelector=ko.observable(),n.widgetStyleViewType=ko.observable(),n.lastWidgetStyleViewType=null,n.apiRequestInProgress=ko.observable(!1),n.contentVisible=ko.observable(!1),n.widgetPreviewVisible=ko.observable(!1),n.widgetPreviewSoundLoaded=!1,n.alertBox=AlertBoxFactory().createDismissibleAlertBox(),n.accountStatusAlertBox=function(){if(!function(){if(e.plusAccountFeaturesEnabled()&&"Pro"===e.premiumAccountTier())return!1;return!0}())return null;return AlertBoxFactory().createInformativeLinkAlertBox("This is just a preview. Custom widgets are only available to Pro subscribers.","red",!0,function(){if(e.canCreatePaidSubscription())return"/premium-pricing";return"https://clyp.freshdesk.com/support/solutions/articles/35000041347-how-do-i-switch-from-plus-to-pro-"}(),"Learn more")}(),n.updateViewTypeClick=function(){return n.widgetStyleViewType()!==n.lastWidgetStyleViewType&&n.update(),!0},n.tryShowWidgetPreview=function(){n.contentVisible()&&n.widgetPreviewSoundLoaded&&i&&i.SoundwaveColorHex&&($(t.soundwave.soundwaveElement).empty(),n.widgetPreviewVisible(!0),a(i.SoundwaveColorHex))},n.logoFileUpload=function(t){var o=new FormData;o.append("imageFile",t);var i={type:"POST",data:o,cache:!1,contentType:!1,processData:!1,url:e.uploadUrl+"me/customwidgetsettings/logo",success:function(){n.initModelFromApi(),n.alertBox.dismissAlert()}};e.handleAuthenticatedRequest(i)},n.soundwaveColorError=function(){return r()&&!o.test(n.soundwaveHex())},n.playButtonColorError=function(){return r()&&!o.test(n.playButtonHex())},n.update=function(){n.apiRequestInProgress(!0);var t={url:e.apiUrl+"me/customwidgetsettings",type:"PUT",data:{SoundwaveColorHex:"#"+n.soundwaveHex(),PlayButtonColorHex:"#"+n.playButtonHex(),ViewType:n.widgetStyleViewType()},success:function(){n.initModelFromApi(),n.alertBox.dismissAlert()},error:function(e){var t;t=e.responseJSON.Message,n.alertBox.dismissAlert(),n.alertBox.message(t),n.alertBox.color("red"),n.alertBox.dismissButtonVisible(!1),n.alertBox.showAlert(),function(){if($("#widget-settings-alert-box").length){var e=20;$("#banner").length&&(e+=$("#banner").height()),$("#clyp-header").length&&(e+=$("#clyp-header").height()),$("html, body").animate({scrollTop:$("#widget-settings-alert-box").offset().top-e},500)}}(),n.apiRequestInProgress(!1)}};e.handleAuthenticatedRequest(t)},n.deleteImage=function(){var t={url:e.apiUrl+"me/customwidgetsettings/logo",type:"DELETE",success:n.initModelFromApi};e.handleAuthenticatedRequest(t)},n.resetToDefaults=function(){var t={url:e.apiUrl+"me/customwidgetsettings",type:"DELETE",success:function(){n.initModelFromApi(),n.alertBox.dismissAlert()}};e.handleAuthenticatedRequest(t)},n.initModelFromApi=function(){var o={url:e.apiUrl+"me/customwidgetsettings",type:"GET",dataType:"json",success:function(e){var o,r,u;i=e,function(e){e.match(/clyp-logo-primary-98x44\.svg$/)?n.logoPreviewUrl(null):n.logoPreviewUrl(e);$("#logo-image").attr("src",e)}(e.LogoPictureUrl),a(e.SoundwaveColorHex),o=e.PlayButtonColorHex,r=o.substring(1),n.playButtonHex(r),$(".widget-preview-card .play-controls-button circle").attr("fill",o),function(e){if(n.soundwaveHexSelector())return;n.soundwaveHexSelector(e),n.soundwaveHexSelector.subscribe(Util.debounce((function(e){e&&(n.soundwaveHex(e.substring(1).toUpperCase()),n.update())}),300))}(e.SoundwaveColorHex),function(e){if(n.playButtonHexSelector())return;n.playButtonHexSelector(e),n.playButtonHexSelector.subscribe(Util.debounce((function(e){e&&(n.playButtonHex(e.substring(1).toUpperCase()),n.update())}),300))}(e.PlayButtonColorHex),u=e.ViewType,n.widgetStyleViewType(u),n.lastWidgetStyleViewType=u,"Default"===u?($("#widget-simple").hide(),$(".soundwave-wrapper").prependTo("#widget .widget-body"),$(".play-controls-button").prependTo("#widget .widget-footer"),$(".widget-preview-card").removeClass("short-card"),$("#widget").show(),t.redrawSoundwave()):"Simple"===u&&($("#widget").hide(),$(".soundwave-wrapper").prependTo("#widget-simple .widget-body"),$(".play-controls-button").prependTo("#widget-simple .widget-body"),$(".widget-preview-card").addClass("short-card"),$("#widget-simple").show(),t.redrawSoundwave()),n.contentVisible(!0),n.tryShowWidgetPreview(),n.apiRequestInProgress(!1)}};e.handleAuthenticatedRequest(o)},e.showAuthenticatedTemplateCallback=n.initModelFromApi,e.userLogoutCallback=e.redirectToHomepage};